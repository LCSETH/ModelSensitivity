resolution = [251,251];
%domain = [-1.5,-0.9;-1, -0.4];
domain = [0,2*pi;0, 2*pi];
range = diff(domain(2,:));
delta = range./resolution(1);
initialPosition = initialize_ic_grid(resolution, domain, 2);
initGrid = zeros(length(initialPosition), 3);
initGrid(:,2) = initialPosition(:,1);
initGrid(:,3) = initialPosition(:,2);

stepSize = 0.1;
lDerivative = @(t,x, e, true) d_abc(t, x, e,true);

time = [0, 8];
lyaps = zeros(length(times),3);

for i=1:length(times)
    time = times(i);
    [helo,~] = computeCGInvariants(lDerivative, [4., 0.6,0.], [0,time], 'eoV');
    lyaps(i,1) = 0.5*log(helo(1,1))/time;
    lyaps(i,2) = 0.5*log(helo(1,2))/time;
    lyaps(i,3) = 0.5*log(helo(1,3))/time;
end
hold on;
plot(times, lyaps(:,1), '.');
plot(times, lyaps(:,2), '.');
plot(times, lyaps(:,3), '.');
xlabel('$T$', 'interpreter', 'latex');
ylabel('FTLE$(\Lambda_0^T)$', 'interpreter', 'latex');
ylim([-2, 3]);

